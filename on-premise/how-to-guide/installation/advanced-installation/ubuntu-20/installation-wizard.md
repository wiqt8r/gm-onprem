# Мастер установки

Шаги установки зависят от того, планируете ли вы использовать **один сервер** (рекомендуется для небольших инсталляций) или **два отдельных сервера** — для приложения и базы данных (для крупных инстанций с более чем 1000 устройств).  
Выберите подходящий вариант ниже в зависимости от вашей конфигурации.

Для установки потребуется дистрибутив платформы **ГдеМои – Локальная версия**.  
Его можно загрузить напрямую на сервер с помощью следующей команды:

```
wget --content-disposition https://get.navixy.com/latest
```
После загрузки пакета можно приступать к установке.

---

## Вариант 1. Один сервер (All-in-one)

Сначала распакуйте архив с пакетом платформы **ГдеМои**, предоставленный в формате `tar.gz`.  
Перейдите в директорию с архивом и выполните команду (замените **<PACKAGE_NAME>** на реальное имя файла):

```
tar -zxvf <PACKAGE_NAME>.tar.gz
```

Архив будет распакован в директорию `/navixy-package`.  
Перейдите в эту директорию и запустите установочный скрипт:

```
./install.sh
```


Скрипт проверит совместимость операционной системы и наличие зависимостей.  
На этом этапе от вас не требуется действий.

---

### Выбор роли сервера

Мастер установки предложит выбрать роль сервера для дальнейшего развёртывания.  
Выберите **Single server – all services in one server** (один сервер — все сервисы размещаются локально).  

Будьте внимательны — другие варианты используются только для установки на два сервера.

![](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230802-134855.png)

---

### Процесс установки

Скрипт выполнит проверку необходимого ПО и автоматически установит компоненты: **Java**, **Nginx** и **MySQL**.  
При появлении запроса на перезапуск MySQL подтвердите, введя `1`.  
Затем подтвердите инициализацию баз данных — введите `y`.

![](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230810-130547.png)

MySQL может запросить root-пароль. Он не обязателен, поэтому можно оставить поле пустым.  
Если вы зададите пароль — обязательно сохраните его.  
После этого скрипт создаст базы данных и пользователя **navixy** с случайным паролем.  
Этот пользователь будет использоваться сервисами платформы для взаимодействия с базой данных.  
Пароль сохраняется автоматически в конфигурационных файлах, поэтому вводить его вручную не потребуется.

![](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230810-130559.png)

После инициализации базы данных появится сообщение:

```
This script will install Navixy platform on this server. Continue? (y/n)
```


Введите `y` для подтверждения и нажмите `Enter`. Скрипт выполнит следующие действия:

* создаст системного пользователя для Java-сервисов (backend);
* создаст и заполнит директории сервисов;
* скопирует и настроит веб-компоненты (frontend);
* добавит runit-скрипты для управления Java-сервисами;
* выполнит базовую настройку компонентов.

---

### Домены

Скрипт запросит основной домен вашей платформы.  
Он используется для доступа к пользовательскому интерфейсу и регистрации устройств.

![Установка Ubuntu — настройка домена](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230802-140224.png)

Затем будет предложено ввести домены для **API** и **панели администратора**:

* для однодоменной установки — оставьте поля пустыми и нажмите Enter;  
* для трёхдоменной конфигурации — укажите соответствующие домены.

![Установка Ubuntu — настройка API](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230802-140910.png)

![Установка Ubuntu — настройка панели администратора](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230802-140938.png)

После подтверждения параметров вы увидите уведомление о конфигурации доменов.

Далее мастер предложит установить SSL-сертификаты для вашей платформы.  
Если хотите включить HTTPS — выберите **Yes** и следуйте подсказкам мастера.

Подробнее об установке SSL-сертификата читайте в разделе [**Мастер конфигурации**](configuration-wizard.md).

На этом базовая установка завершена.  
Для дополнительной настройки воспользуйтесь скриптом [**./configure.sh**](configuration-wizard.md).

---

## Вариант 2. Два сервера

Сначала загрузите и распакуйте архив **ГдеМои – Локальная версия** на **оба сервера**.  
Выполните команду (замените **<PACKAGE_NAME>** на реальное имя файла):

```
tar -zxvf <PACKAGE_NAME>.tar.gz
```

Пакет будет распакован в директорию **navixy-package**.  
Сначала выполните установку **на сервере базы данных**, затем — **на сервере приложения**.

---

### Сервер базы данных

Откройте директорию `/navixy-package` и запустите скрипт установки:

```
./install.sh
```


Когда появится запрос о выборе роли сервера, выберите **#2 SQL server**.

![Установка Ubuntu — сервер базы данных](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230803-135111.png)

Скрипт выполнит проверку системы и установит MySQL.  
Подтвердите перезапуск MySQL, введя `1`, затем инициализацию баз данных (`y`).

![](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230810-130630.png)

MySQL предложит задать root-пароль (можно пропустить).  
После этого создастся пользователь **navixy** и базы данных.

![](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230810-130640.png)

По завершении появится информация о сервере БД:

* **Пользователь:** `navixy`  
* **Пароль:** (случайно сгенерированный)  
* **IP-адрес:** адрес вашего SQL-сервера  

![](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230810-130655.png)

Сохраните эти данные — они понадобятся при установке сервера приложений.

---

### Сервер приложения

На втором сервере откройте `/navixy-package` и выполните:

```
./install.sh
```


Выберите роль **#3 Application server**.

![Установка Ubuntu — сервер приложения](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230803-135805.png)

Скрипт автоматически установит Java, Nginx и другие зависимости.  
Затем запросит пароль пользователя **navixy** и IP-адрес сервера базы данных.

Пароль можно вставить с помощью `Shift+Insert`.

![Настройка MySQL](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230803-135651.png)

Введите IP-адрес SQL-сервера и подтвердите установку, введя `y`.

![Подтверждение установки](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230810-130708.png)

---

### Домены

Укажите основной домен вашей платформы.

![Настройка домена](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230802-140224.png)

Затем введите домены для **API** и **панели администратора**:

* оставьте пустыми — для однодоменной установки;  
* укажите — для трёхдоменной.

![Настройка API-домена](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230802-140910.png)

![Настройка домена панели администратора](../../../../../on-premise/on-premise/platform-installation/advanced-installation/ubuntu-20/attachments/image-20230802-140938.png)

После подтверждения вы увидите уведомление о конфигурации.  
При необходимости активируйте SSL — выберите **Yes** и следуйте инструкциям.

Подробнее об установке сертификатов см. [**Мастер конфигурации**](configuration-wizard.md).

---

На этом базовая установка платформы **ГдеМои – Локальная версия** завершена.  
Для расширенной настройки и оптимизации используйте скрипт [**./configure.sh**](configuration-wizard.md).

---

Если в процессе установки возникнут вопросы, обратитесь в **отдел технических решений** по адресу  
[**solutions@gdemoi.ru**](mailto:solutions@gdemoi.ru).

